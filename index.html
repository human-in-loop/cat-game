<!doctype html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-select: none"/>
<title>Cat Hunt - Mobile Friendly</title>
<style>
  body {
    margin: 0;
    background: #000b1a;
    overflow: hidden;
    touch-action: none;
    font-family: sans-serif;
  }
  .prey {
    position: absolute;
    width: 25px;
    height: 25px;
    border-radius: 50%;
    z-index: 5;
    background: radial-gradient(circle at 30% 30%, #ffcc00, #aa8800);
    box-shadow: 0 0 8px rgba(255, 200, 0, 0.8);
  }
  #start {
    position: fixed;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 32px;
    color: white;
    background: #000;
    z-index: 100;
    cursor: pointer;
  }
  #muteBtn {
    position: fixed;
    bottom: 30px;
    left: 30px;
    padding: 12px 25px;
    background: #111;
    color: #ffff00;
    border: 2px solid #ffff00;
    border-radius: 30px;
    z-index: 110;
    font-size: 16px;
    cursor: pointer;
  }
</style>
</head>
<body>
<div id="start">TAP TO START üêæ</div>
<button id="muteBtn">MUTE ALL</button>

<script>
let audioCtx, masterGain;
let isMuted = false;

// Initialize audio context on first user gesture
function initAudio() {
  if (!audioCtx) {
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    masterGain = audioCtx.createGain();
    masterGain.connect(audioCtx.destination);
  }
}

// Short unpredictable squeak (like a mouse)
function playSqueak() {
  if (!audioCtx || isMuted) return;
  const osc = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  osc.type = "triangle";
  osc.frequency.setValueAtTime(2000 + Math.random() * 1500, audioCtx.currentTime);
  g.gain.setValueAtTime(0.08, audioCtx.currentTime);
  osc.connect(g);
  g.connect(masterGain);
  osc.start();
  osc.stop(audioCtx.currentTime + 0.05 + Math.random() * 0.05);
}

// Tiny pop sound when caught
function playPop() {
  if (!audioCtx || isMuted) return;
  const osc = audioCtx.createOscillator();
  const g = audioCtx.createGain();
  osc.frequency.setValueAtTime(500, audioCtx.currentTime);
  osc.frequency.exponentialRampToValueAtTime(50, audioCtx.currentTime + 0.1);
  g.gain.setValueAtTime(0.1, audioCtx.currentTime);
  osc.connect(g);
  g.connect(masterGain);
  osc.start();
  osc.stop(audioCtx.currentTime + 0.1);
}

// Spawn a single prey
function spawnPrey() {
  const prey = document.createElement("div");
  prey.className = "prey";
  let x = Math.random() * (window.innerWidth - 30);
  let y = Math.random() * (window.innerHeight - 30);
  prey.style.left = x + "px";
  prey.style.top = y + "px";
  document.body.appendChild(prey);

  let dx = (Math.random() - 0.5) * 6; // random x velocity
  let dy = (Math.random() - 0.5) * 6; // random y velocity

  // Movement interval
  const move = setInterval(() => {
    x += dx;
    y += dy;

    // Bounce off walls
    if (x < 0 || x > window.innerWidth - 25) dx *= -1;
    if (y < 0 || y > window.innerHeight - 25) dy *= -1;

    // Random sudden bursts
    if (Math.random() < 0.02) {
      dx = (Math.random() - 0.5) * 12;
      dy = (Math.random() - 0.5) * 12;
      playSqueak(); // occasional squeak
    }

    prey.style.left = x + "px";
    prey.style.top = y + "px";
  }, 25);

  // Interaction: cat ‚Äúpounces‚Äù
  prey.onpointerdown = (e) => {
    e.preventDefault();
    playPop();
    clearInterval(move);
    prey.remove();
  };

  // Remove after 8 seconds if not caught
  setTimeout(() => {
    clearInterval(move);
    if (prey.parentNode) prey.remove();
  }, 8000);
}

// Start game
document.getElementById("start").addEventListener("click", () => {
  initAudio();
  // Play a first squeak immediately to unlock audio on mobile
  playSqueak();

  document.getElementById("start").style.display = "none";

  // Spawn prey at random intervals
  setInterval(spawnPrey, 1500 + Math.random() * 1500);
});

// Mute button
document.getElementById("muteBtn").onclick = () => {
  isMuted = !isMuted;
  if (masterGain) {
    masterGain.gain.setTargetAtTime(isMuted ? 0 : 1, audioCtx.currentTime, 0.05);
  }
  document.getElementById("muteBtn").textContent = isMuted ? "UNMUTE" : "MUTE ALL";
};
</script>
</body>
</html>
